<html>
<head>
</head>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.0/js.cookie.min.js"></script>

<script>
    $(document).ready(function () {

        var form = document.getElementById('fileForm');
        var fileSelect = document.getElementById('fileSelect');
        var uploadButton = document.getElementById('uploadButton');
        var fileSpace = $('#file-space');

        $.ajax({
            type: 'POST',
            url: ('http://localhost:3000/file/getFiles?token=' + Cookies.get('token')),
            success: function(data) {
                fileSpace.html(JSON.stringify(data));
            }
        });

        // File upload
        form.onsubmit = function (event) {
            event.preventDefault();

            // Get the selected files from the input.
            var files = fileSelect.files;
            var file = files[0];

            // Create a new FormData object.
            var formData = new FormData();

            if ((!file.type.match('image.*'))
                    && (!file.type.match('\.pdf'))) {
                alert("Sorry. The system only supports image files and PDF files.");

            } else {
                formData.append('userUpload', file, file.name);
                // Set up the request.
                var xhr = new XMLHttpRequest();

                // Open the connection.
                xhr.open('POST', 'http://localhost:3000/file/upload?token=' + Cookies.get('token'), true);
                xhr.send(formData);
            }
        }
    });

</script>

<div>
    <h1>My Files</h1>
    <div id="file-space">
    </div>
</div>
<!-- Upload Module UI -->
<div id="uploadWrapper">
    <h1 id="title">
        File Upload Module
    </h1>
    <h1>
        <form id="fileForm" action="http://localhost:3000/fileupload" method="POST" enctype="multipart/form-data">
            <input type="file" id="fileSelect"/>
            <button type="submit" id="uploadButton">Upload</button>
        </form>
    </h1>
</div>

</html>